%dw 2.0
output application/csv deferred=true
var udcs = vars.outboundUDCs.sku[0].sku[0]
var lib = readUrl("classpath://config-repo/scpoadapter/resources/dwl/host-scpo-udc-mapping.dwl")
---
(payload map {
	 "itemLocation.documentActionCode": "CHANGE_BY_REFRESH",	
	"itemLocation.itemLocationIditemLocation.item.primaryId": $.ITEM,
	"itemLocation.itemLocationIditemLocation.location.primaryId": $.LOC,
	"itemLocation.businessInstanceId": if($.ENABLEOPT != null) $.ENABLEOPT else "",
	"itemLocation.statusCode": "ACTIVE",
	"itemLocation.onHandInventoryQuantity.value": if($.OH != null) $.OH else "" ,
	"itemLocation.onHandInventoryPostingDate": if($.OHPOST != null) $.OHPOST as DateTime else "",
	"itemLocation.resource": if($.RES != null) $.RES else "" ,
	"itemLocation.hasInfiniteSupply": if($.INFINITESUPPLYSW == 0) false else true,
	"itemLocation.isStorable": if($.STORABLESW == 0) false else true,
	"itemLocation.replenishmentMethod": if($.REPLENMETHOD == 1) 'REPLENISHMENT_ONLY' else if($.REPLENMETHOD == 2) 'ALLOCATION_ONLY' else if($.REPLENMETHOD == 3) 'REPLENISHMENT_AND_ALLOCATION' else null,
	"itemLocation.replenishmentType": if($.REPLENTYPE == 1) 'TRANSFERRED' else if($.REPLENTYPE == 2) 'ASSEMBLED' else if($.REPLENTYPE == 4) 'INTERFACE' else if($.REPLENTYPE == 5) 'MPS' else null,
	"itemLocation.demandParameters.cumulativeDemandQuantity.value":  if($.DMDTODATE != null) $.DMDTODATE else "",
	"itemLocation.demandParameters.unitCost.value":  if($.INDDMDUNITCOST != null) $.INDDMDUNITCOST else "",
	"itemLocation.demandParameters.unitMargin.value": if($.INDDMDUNITMARGIN != null) $.INDDMDUNITMARGIN else "",
	"itemLocation.demandParameters.unitInventoryCarryingCost.value": if($.UNITCARCOST != null) $.UNITCARCOST else "",
	"itemLocation.demandParameters.unitPrice.value":  if($.UNITPRICE != null) $.UNITPRICE else "",
	"itemLocation.demandParameters.pricingCalendar":  if($.PRICECAL != null) $.PRICECAL else "",
	"itemLocation.deploymentParameters.initialStockoutCost.value":  if($.INITSTKOUTCOST != null) $.INITSTKOUTCOST else "",
	"itemLocation.deploymentParameters.surplusRestockCost.value":  if($.SURPLUSRESTOCKCOST != null) $.SURPLUSRESTOCKCOST else "",
	"itemLocation.effectiveInventoryParameters.effectiveFromDateTime":   if($.EFFINV_EFF != null) $.EFFINV_EFF as DateTime else "",
	"itemLocation.effectiveInventoryParameters.maximumCoverageDuration.value":  if($.MAXCOVDUR != null) $.MAXCOVDUR else "",
	"itemLocation.effectiveInventoryParameters.maximumOnHandQuantity.value":  if($.MAXOHQTY != null) $.MAXOHQTY else "",
	"itemLocation.effectiveInventoryParameters.minimumSafetyStockQuantity.value":  if($.MINSSQTY != null) $.MINSSQTY else "",
	"itemLocation.effectiveInventoryParameters.safetyStockCoverageDuration.value":  if($.SSCOVDUR != null) $.SSCOVDUR else "", 
	"itemLocation.effectiveInventoryParameters.demandChannel":  if($.DMDGROUP != null) $.DMDGROUP else "",
	"itemLocation.inventoryOptimizationParameters.averageRequisitionQuantity.value":  if($.AVGRQSNSIZE != null) $.AVGRQSNSIZE else "",
	"itemLocation.inventoryOptimizationParameters.groupName": if($.GROUPNAME != null) $.GROUPNAME else "",
	"itemLocation.inventoryOptimizationParameters.annualRequisitionNumber":if($.NUMRQSN != null)  $.NUMRQSN else "",
	"itemLocation.inventoryOptimizationParameters.reviewGroup": if($.REVIEWGROUP != null) $.REVIEWGROUP else "",
	"itemLocation.inventoryOptimizationParameters.sensitivityProfile": if($.SENSITIVITYPROFILE != null) $.SENSITIVITYPROFILE else "",
	"itemLocation.inventoryOptimizationParameters.inventoryOptimizationEffectiveParameters.backOrderPenaltyAmount.value":  if($.BACKORDERPENALTY != null) $.BACKORDERPENALTY else "",
	"itemLocation.inventoryOptimizationParameters.inventoryOptimizationEffectiveParameters.coefficientVariation":  if($.COEFFVAR != null) $.COEFFVAR else "",
	"itemLocation.inventoryOptimizationParameters.inventoryOptimizationEffectiveParameters.effectiveFromDate": if($.EFFIO_EFF != null) $.EFFIO_EFF as Date{format:"yyyy-MM-dd",class:"java.sql.Date"} else "",
	"itemLocation.inventoryOptimizationParameters.inventoryOptimizationEffectiveParameters.endOfLifeDemand": if($.ENDOFLIFEDMD != null) $.ENDOFLIFEDMD else "",
	"itemLocation.inventoryOptimizationParameters.inventoryOptimizationEffectiveParameters.eventType":  if($.EVENTTYPE != null) $.EVENTTYPE else "",
	"itemLocation.inventoryOptimizationParameters.inventoryOptimizationEffectiveParameters.handlingCost.value":  if($.HANDLINGCOST != null) $.HANDLINGCOST else "",
	"itemLocation.inventoryOptimizationParameters.inventoryOptimizationEffectiveParameters.holdingCost.value":  if($.EFFIO_HOLDINGCOST != null) $.EFFIO_HOLDINGCOST else "",
	"itemLocation.inventoryOptimizationParameters.inventoryOptimizationEffectiveParameters.inventoryOptimizationServiceProfile":  if($.IOSERVICEPROFILE != null) $.IOSERVICEPROFILE else "",
	"itemLocation.inventoryOptimizationParameters.inventoryOptimizationEffectiveParameters.maximumReOrderQuantity.value":  if($.MAXREORDERQTY != null) $.MAXREORDERQTY else "",
	"itemLocation.inventoryOptimizationParameters.inventoryOptimizationEffectiveParameters.minimumReOrderQuantity.value":  if($.MINREORDERQTY != null) $.MINREORDERQTY else "",
	"itemLocation.inventoryOptimizationParameters.inventoryOptimizationEffectiveParameters.orderCost.value":  if($.ORDERCOST != null) $.ORDERCOST else "",
	"itemLocation.inventoryOptimizationParameters.inventoryOptimizationEffectiveParameters.overStockPenaltyAmount.value":  if($.OVERSTOCKPENALTY != null) $.OVERSTOCKPENALTY else "",
	"itemLocation.inventoryOptimizationParameters.inventoryOptimizationEffectiveParameters.replenishmentPolicy":  if($.REPLENPOLICY != null) $.REPLENPOLICY else "",
	"itemLocation.inventoryOptimizationParameters.inventoryOptimizationEffectiveParameters.reviewPeriodDuration.value":  if($.REVIEWPERIOD != null) $.REVIEWPERIOD else "",
	"itemLocation.inventoryOptimizationParameters.inventoryOptimizationEffectiveParameters.stockOutPenaltyAmount.value":  if($.STOCKOUTPENALTY != null) $.STOCKOUTPENALTY else "",
	"itemLocation.inventoryOptimizationParameters.inventoryOptimizationEffectiveParameters.unitCost.value":  if($.UNITCOST != null) $.UNITCOST else "",
	"itemLocation.perishableParameters.shelfLifeDuration.value":  if($.SHELFLIFEDUR != null) $.SHELFLIFEDUR else "",
	"itemLocation.perishableParameters.minimumShelfLifeDuration.value":  if($.MINSHELFLIFEDUR != null) $.MINSHELFLIFEDUR else "",
	"itemLocation.perishableParameters.minimumShipmentShelfLifeDuration.value":  if($.MINSHIPSHELFLIFEDUR != null) $.MINSHIPSHELFLIFEDUR else "",
	"itemLocation.perishableParameters.maximumShelfLifeDuration.value":  if($.MAXSHELFLIFEDUR != null) $.MAXSHELFLIFEDUR else "",
	"itemLocation.planningParameters.supplyLeadBufferDuration.value":  if($.BUFFERLEADTIME != null) $.BUFFERLEADTIME else "",
	"itemLocation.planningParameters.receiptCoverageDuration.value":  if($.DRPCOVDUR != null) $.DRPCOVDUR else "",
	"itemLocation.planningParameters.supplyCoverageDuration.value":  if($.MPSCOVDUR != null) $.MPSCOVDUR else "",
	"itemLocation.planningParameters.receiptFrozenDuration.value":  if($.DRPFRZDUR != null) $.DRPFRZDUR else "",
	"itemLocation.planningParameters.holdingCost.value":  if($.PLANPARAM_HOLDINGCOST != null) $.PLANPARAM_HOLDINGCOST else "",
	"itemLocation.planningParameters.incrementalDRPQuantity.value":  if($.INCDRPQTY != null) $.INCDRPQTY else "",
	"itemLocation.planningParameters.incrementalMPSQuantity.value":  if($.INCMPSQTY != null) $.INCMPSQTY else "",
	"itemLocation.planningParameters.receivingHandlingCost.value":  if($.INHANDLINGCOST != null) $.INHANDLINGCOST else "",
	"itemLocation.planningParameters.maximumOnHandQuantity.value":  if($.PLANPARAM_MAXOH != null) $.PLANPARAM_MAXOH else "",
	"itemLocation.planningParameters.manufactureDuration.value":  if($.MFGFRZDUR != null) $.MFGFRZDUR else "", 
	"itemLocation.planningParameters.manufactureLeadTimeDuration.value":  if($.MFGLEADTIME != null) $.MFGLEADTIME else "",
	"itemLocation.planningParameters.minimumDRPQuantity.value":  if($.MINDRPQTY != null) $.MINDRPQTY else "",
	"itemLocation.planningParameters.minimumMPSQuantity.value":  if($.MINMPSQTY != null) $.MINMPSQTY else "",
	"itemLocation.planningParameters.orderingCost.value":  if($.ORDERINGCOST != null) $.ORDERINGCOST else "",
	"itemLocation.planningParameters.shippingHandlingCost.value":  if($.OUTHANDLINGCOST != null) $.OUTHANDLINGCOST else "",
	"itemLocation.planningParameters.shrinkageFactor":  if($.SHRINKAGEFACTOR != null) $.SHRINKAGEFACTOR else "",
	"itemLocation.planningParameters.useWorkInProgressQuantity": if($.USEWIPSW == 0) false else true,
	"itemLocation.safetyStockParameters.safetyStockRuleCode":  if($.SSRULE != null) $.SSRULE as String else "",
	"itemLocation.safetyStockParameters.accumulationDuration.value":  if($.ACCUMDUR != null) $.ACCUMDUR else "",
	"itemLocation.safetyStockParameters.averageReplenishmentLeadDuration.value":  if($.AVGLEADTIME != null) $.AVGLEADTIME else "",
	"itemLocation.safetyStockParameters.maximumSafetyStock.value":  if($.SSPARAM_MAXSS != null) $.SSPARAM_MAXSS else "",
	"itemLocation.safetyStockParameters.minimumSafetyStock.value":  if($.MINSS != null) $.MINSS else "",
	"itemLocation.safetyStockParameters.safetyStockCoverageDuration.value":  if($.SSCOV != null) $.SSCOV else "",
	"itemLocation.safetyStockParameters.safetyStockCustomerServiceLevel":  if($.STATSSCSL != null) $.STATSSCSL else "",
	"itemLocation.safetyStockPresentation.actionCode": "ADD",
	"itemLocation.safetyStockPresentation.effectiveFromDateTime":  if($.SSPR_EFF != null) $.SSPR_EFF as DateTime else "",
	"itemLocation.safetyStockPresentation.effectiveUpToDateTime":  if($.DISC != null) $.DISC as DateTime else "",
	"itemLocation.safetyStockPresentation.displayQuantity.value":  if($.DISPLAYQTY != null) $.DISPLAYQTY else "",
	"itemLocation.safetyStockPresentation.presentationQuantity.value":  if($.PRESENTATIONQTY != null) $.PRESENTATIONQTY else "",
	"itemLocation.safetyStockPresentation.maximumOnHandQuantity.value":  if($.SSPR_MAXOH != null) $.SSPR_MAXOH else "",
	"itemLocation.safetyStockPresentation.maximumSafetyStock.value":  if($.SSPR_MAXSS != null) $.SSPR_MAXSS else "",
    (udcs map (udc , index) -> {
		((udc.hostColumnName): lib.eval($[udc.scpoColumnName] , upper(udc.dataType)))
	}),
})
