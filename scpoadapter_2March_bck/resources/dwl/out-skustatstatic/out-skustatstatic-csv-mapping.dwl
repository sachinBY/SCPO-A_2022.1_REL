%dw 2.0
output application/csv
var udcs = vars.outboundUDCs.skustatstatic[0].skustatstatic[0]
var lib = readUrl("classpath://config-repo/scpoadapter/resources/dwl/host-scpo-udc-mapping.dwl")
---
payload map {
	"itemLocationStatistics.itemLocationStatisticsId.itemId": $.ITEM,
	"itemLocationStatistics.itemLocationStatisticsId.locationId": $.LOC,
	"itemLocationStatistics.optionSet": $.OPTIONSET,
	"itemLocationStatistics.processDateTime": $.PROCESSDATE,
	"itemLocationStatistics.startDateTime": $.STARTDATE,
	"itemLocationStatistics.duration.value": $.DUR,
	"itemLocationStatistics.backOrders": $.BACKORDERS,
	"itemLocationStatistics.overstockDateTime": $.OVERSTOCKDATE,
	"itemLocationStatistics.constrainedOverstockDateTime": $.CONSTROVERSTOCKDATE,
	"itemLocationStatistics.alternateConstrainedOverstockDateTime": $.ALTCONSTROVERSTOCKDATE,
	"itemLocationStatistics.overstockQuantity": $.OVERSTOCKQTY,
	"itemLocationStatistics.constrainedOverstockQuantity": $.CONSTROVERSTOCKQTY,
	"itemLocationStatistics.alternateConstrainedOverstockQuantity": $.ALTCONSTROVERSTOCKQTY,
	"itemLocationStatistics.overstockDuration.value": $.OVERSTOCKDUR,
	"itemLocationStatistics.constrainedOverstockDuration.value": $.CONSTROVERSTOCKDUR,
	"itemLocationStatistics.alternateConstrainedOverstockDuration.value": $.ALTCONSTROVERSTOCKDUR,
	"itemLocationStatistics.overstockInventoryStartDateTime": $.OVERSTOCKINVSTARTDATE,
	"itemLocationStatistics.constrainedOverstockInventoryStartDateTime": $.CONSTROVERSTOCKINVSTARTDATE,
	"itemLocationStatistics.alternateConstrainedOverstockInventoryStartDateTime": $.ALTCONSTROVERSTOCKINVSTARTDATE,
	"itemLocationStatistics.overstockExcessCoverageDuration.value": $.OVERSTOCKEXCESSCOVDUR,
	"itemLocationStatistics.constrainedOverstockExcessCoverageDuration.value": $.CONSTROVERSTOCKEXCESSCOVDUR,
	"itemLocationStatistics.alternateConstrainedOverstockExcessCoverageDuration.value": $.ALTCONSTROVERSTOCKEXCESSCOVDUR,
	"itemLocationStatistics.maximumProjectedOnHand": $.MAXPROJOH,
	"itemLocationStatistics.maximumConstrainedProjectedOnHand": $.MAXCONSTRPROJOH,
	"itemLocationStatistics.maximumProjectedOnHandDateTime": $.MAXPROJOHDATE,
	"itemLocationStatistics.maximumConstrainedProjectedOnHandDateTime": $.MAXCNSTRPROJOHDATE,
	"itemLocationStatistics.minimumCoverageDuration.value": $.MINCOVDUR,
	"itemLocationStatistics.maximumCoverageDuration.value": $.MAXCOVDUR,
	"itemLocationStatistics.currentCoverageDuration.value": $.CURCOVDUR,
	"itemLocationStatistics.currentConstrainedCoverageDuration.value": $.CURCONSTRCOVDUR,
	"itemLocationStatistics.minimumCoverageDateTime": $.MINCOVDATE,
	"itemLocationStatistics.maximumCoverageDateTime": $.MAXCOVDATE,
	"itemLocationStatistics.minimumConstrainedCoverageDateTime": $.MINCONSTRCOVDATE,
	"itemLocationStatistics.maximumConstrainedCoverageDateTime": $.MAXCONSTRCOVDATE,
	"itemLocationStatistics.minimumConstrainedCoverageDuration.value": $.MINCONSTRCOVDUR,
	"itemLocationStatistics.maximumConstrainedCoverageDuration.value": $.MAXCONSTRCOVDUR,
	"itemLocationStatistics.stockLowDateTime": $.STOCKLOWDATE,
	"itemLocationStatistics.constrainedStockLowDateTime": $.CONSTRSTOCKLOWDATE,
	"itemLocationStatistics.alternateConstrainedStockLowDateTime": $.ALTCONSTRSTOCKLOWDATE,
	"itemLocationStatistics.stockLowDuration.value": $.STOCKLOWDUR,
	"itemLocationStatistics.constrainedStockLowDuration.value": $.CONSTRSTOCKLOWDUR,
	"itemLocationStatistics.alternateConstrainedStockLowDuration.value": $.ALTCONSTRSTOCKLOWDUR,
	"itemLocationStatistics.stockLowQuantity": $.STOCKLOWQTY,
	"itemLocationStatistics.constrainedStockLowQuantity": $.CONSTRSTOCKLOWQTY,
	"itemLocationStatistics.alternateConstrainedStockLowQuantity": $.ALTCONSTRSTOCKLOWQTY,
	"itemLocationStatistics.stockoutQuantity": $.STOCKOUTQTY,
	"itemLocationStatistics.constrainedStockoutQuantity": $.CONSTRSTOCKOUTQTY,
	"itemLocationStatistics.alternateConstrainedStockoutQuantity": $.ALTCONSTRSTOCKOUTQTY,
	"itemLocationStatistics.stockoutDuration.value": $.STOCKOUTDUR,
	"itemLocationStatistics.constrainedStockoutDuration.value": $.CONSTRSTOCKOUTDUR,
	"itemLocationStatistics.alternateConstrainedStockoutDuration.value": $.ALTCONSTRSTOCKOUTDUR,
	"itemLocationStatistics.stockoutDateTime": $.STOCKOUTDATE,
	"itemLocationStatistics.constrainedStockoutDateTime": $.CONSTRSTOCKOUTDATE,
	"itemLocationStatistics.alternateConstrainedStockoutDateTime": $.ALTCONSTRSTOCKOUTDATE,
	"itemLocationStatistics.unconstrainedNumberOfNewActions": $.UNCONNUMNEW,
	"itemLocationStatistics.unconstrainedNumberOfPullActions": $.UNCONNUMPULL,
	"itemLocationStatistics.unconstrainedNumberOfPushActions": $.UNCONNUMPUSH,
	"itemLocationStatistics.unconstrainedNumberOfCancelActions": $.UNCONNUMCANCEL,
	"itemLocationStatistics.unconstrainedRevenueNewActions": $.UNCONREVNEW,
	"itemLocationStatistics.unconstrainedRevenuePullActions": $.UNCONREVPULL,
	"itemLocationStatistics.unconstrainedRevenuePushActions": $.UNCONREVPUSH,
	"itemLocationStatistics.unconstrainedRevenueCancelActions": $.UNCONREVCANCEL,
	"itemLocationStatistics.firstPlanArrivalDateTime": $.FIRSTPLANARRIVDATE,
	"itemLocationStatistics.firstPlanArrivalQuantity": $.FIRSTPLANARRIVQTY,
	"itemLocationStatistics.unconstrainedNetAvailableQuantityAtLeadTime": $.UNCONNETAVLQTYATLT,
	"itemLocationStatistics.unconstrainedNetAvailableNegativeDateTime": $.UNCONNETAVLNEGDATE,
	"itemLocationStatistics.lateInTransitsIn": $.LATEINTRANSIN,
	"itemLocationStatistics.userID": $.USERID,
    (udcs map (udc , index) -> {
		((udc.hostColumnName): lib.eval($[udc.scpoColumnName] , upper(udc.dataType)))
	}),
}  	   
