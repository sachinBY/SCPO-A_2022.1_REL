%dw 2.0
output application/java
---
if(vars.filterCondition != null)
	"SELECT COUNT(*) FROM (SELECT  SKU.*, SKUDEMANDPARAM.INDDMDUNITCOST,SKUDEMANDPARAM.PRICECAL ,SKUDEMANDPARAM.INDDMDUNITMARGIN,SKUDEMANDPARAM.UNITCARCOST,SKUDEMANDPARAM.UNITPRICE,SKUDEMANDPARAM.DMDTODATE, SKUDEPLOYMENTPARAM.INITSTKOUTCOST,SKUDEPLOYMENTPARAM.SURPLUSRESTOCKCOST, SKUEFFINVENTORYPARAM.MAXOHQTY, SKUEFFINVENTORYPARAM.MINSSQTY,SKUEFFINVENTORYPARAM.SSCOVDUR,SKUEFFINVENTORYPARAM.EFF AS EFFINV_EFF,SKUEFFINVENTORYPARAM.MAXCOVDUR,SKUPLANNINGPARAM.USEWIPSW,SKUPLANNINGPARAM.BUFFERLEADTIME,SKUPLANNINGPARAM.DRPFRZDUR,SKUPLANNINGPARAM.HOLDINGCOST AS PLANPARAM_HOLDINGCOST,SKUPLANNINGPARAM.INCDRPQTY,SKUPLANNINGPARAM.INCMPSQTY,SKUPLANNINGPARAM.INHANDLINGCOST,SKUPLANNINGPARAM.MAXOH AS PLANPARAM_MAXOH,SKUPLANNINGPARAM.MFGFRZDUR,SKUPLANNINGPARAM.MFGLEADTIME,SKUPLANNINGPARAM.MINDRPQTY,SKUPLANNINGPARAM.MINMPSQTY,SKUPLANNINGPARAM.OUTHANDLINGCOST,SKUPLANNINGPARAM.SHRINKAGEFACTOR,SKUPLANNINGPARAM.MPSCOVDUR,SKUPLANNINGPARAM.ORDERINGCOST,SKUPLANNINGPARAM.DRPCOVDUR, SKUSAFETYSTOCKPARAM.MAXSS AS SSPARAM_MAXSS,SKUSAFETYSTOCKPARAM.MINSS,SKUSAFETYSTOCKPARAM.SSCOV,SKUSAFETYSTOCKPARAM.STATSSCSL,SKUSAFETYSTOCKPARAM.ACCUMDUR,SKUSAFETYSTOCKPARAM.AVGLEADTIME,SKUSAFETYSTOCKPARAM.SSRULE,SKUPERISHABLEPARAM.MINSHELFLIFEDUR,SKUPERISHABLEPARAM.MINSHIPSHELFLIFEDUR,SKUPERISHABLEPARAM.SHELFLIFEDUR,SKUPERISHABLEPARAM.MAXSHELFLIFEDUR,SS.EFF AS SS_EFF,SS.QTY,SS.DMDGROUP,SKUIOPARAM.AVGRQSNSIZE,SKUIOPARAM.GROUPNAME,SKUIOPARAM.NUMRQSN,SKUIOPARAM.REVIEWGROUP,SKUIOPARAM.SENSITIVITYPROFILE,SKUEFFIOPARAM.UNITCOST,SKUEFFIOPARAM.STOCKOUTPENALTY,SKUEFFIOPARAM.REVIEWPERIOD,SKUEFFIOPARAM.REPLENPOLICY,SKUEFFIOPARAM.OVERSTOCKPENALTY,SKUEFFIOPARAM.ORDERCOST,SKUEFFIOPARAM.MINREORDERQTY,SKUEFFIOPARAM.MAXREORDERQTY,SKUEFFIOPARAM.IOSERVICEPROFILE,SKUEFFIOPARAM.HOLDINGCOST AS EFFIO_HOLDINGCOST,SKUEFFIOPARAM.HANDLINGCOST,SKUEFFIOPARAM.EVENTTYPE,SKUEFFIOPARAM.ENDOFLIFEDMD,SKUEFFIOPARAM.EFF AS EFFIO_EFF,SKUEFFIOPARAM.COEFFVAR,SKUEFFIOPARAM.BACKORDERPENALTY,STORAGEREQUIREMENT.RES,STORAGEREQUIREMENT.ENABLEOPT AS REQ_ENABLEOPT,SSPRESENTATION.EFF AS SSPR_EFF,SSPRESENTATION.DISC,SSPRESENTATION.PRESENTATIONQTY,SSPRESENTATION.DISPLAYQTY,SSPRESENTATION.MAXSS AS SSPR_MAXSS,SSPRESENTATION.MAXOH AS SSPR_MAXOH FROM SKU SKU LEFT JOIN SKUDEMANDPARAM SKUDEMANDPARAM ON SKU.ITEM = SKUDEMANDPARAM.ITEM AND SKU.LOC = SKUDEMANDPARAM.LOC LEFT JOIN SKUDEPLOYMENTPARAM SKUDEPLOYMENTPARAM ON SKU.ITEM = SKUDEPLOYMENTPARAM.ITEM AND SKU.LOC = SKUDEPLOYMENTPARAM.LOC LEFT JOIN SKUEFFINVENTORYPARAM SKUEFFINVENTORYPARAM ON SKU.ITEM = SKUEFFINVENTORYPARAM.ITEM AND SKU.LOC = SKUEFFINVENTORYPARAM.LOC LEFT JOIN SKUPLANNINGPARAM SKUPLANNINGPARAM ON SKU.ITEM = SKUPLANNINGPARAM.ITEM AND SKU.LOC = SKUPLANNINGPARAM.LOC LEFT JOIN SKUSAFETYSTOCKPARAM SKUSAFETYSTOCKPARAM ON SKU.ITEM = SKUSAFETYSTOCKPARAM.ITEM AND SKU.LOC = SKUSAFETYSTOCKPARAM.LOC LEFT JOIN SKUPERISHABLEPARAM SKUPERISHABLEPARAM ON SKU.ITEM = SKUPERISHABLEPARAM.ITEM AND SKU.LOC = SKUPERISHABLEPARAM.LOC LEFT JOIN SS SS ON SKU.ITEM = SS.ITEM AND SKU.LOC = SS.LOC LEFT JOIN SKUIOPARAM SKUIOPARAM ON SKU.ITEM = SKUIOPARAM.ITEM AND SKU.LOC = SKUIOPARAM.LOC LEFT JOIN SKUEFFIOPARAM SKUEFFIOPARAM ON SKU.ITEM = SKUEFFIOPARAM.ITEM AND SKU.LOC = SKUEFFIOPARAM.LOC LEFT JOIN STORAGEREQUIREMENT STORAGEREQUIREMENT ON SKU.ITEM = STORAGEREQUIREMENT.ITEM AND SKU.LOC = STORAGEREQUIREMENT.LOC LEFT JOIN SSPRESENTATION SSPRESENTATION ON SKU.ITEM = SSPRESENTATION.ITEM AND SKU.LOC = SSPRESENTATION.LOC" ++ " WHERE " ++ vars.filterCondition ++ ")"
else	
	"SELECT COUNT(*) FROM (SELECT  SKU.*, SKUDEMANDPARAM.INDDMDUNITCOST,SKUDEMANDPARAM.PRICECAL ,SKUDEMANDPARAM.INDDMDUNITMARGIN,SKUDEMANDPARAM.UNITCARCOST,SKUDEMANDPARAM.UNITPRICE,SKUDEMANDPARAM.DMDTODATE, SKUDEPLOYMENTPARAM.INITSTKOUTCOST,SKUDEPLOYMENTPARAM.SURPLUSRESTOCKCOST, SKUEFFINVENTORYPARAM.MAXOHQTY, SKUEFFINVENTORYPARAM.MINSSQTY,SKUEFFINVENTORYPARAM.SSCOVDUR,SKUEFFINVENTORYPARAM.EFF AS EFFINV_EFF,SKUEFFINVENTORYPARAM.MAXCOVDUR,SKUPLANNINGPARAM.USEWIPSW,SKUPLANNINGPARAM.BUFFERLEADTIME,SKUPLANNINGPARAM.DRPFRZDUR,SKUPLANNINGPARAM.HOLDINGCOST AS PLANPARAM_HOLDINGCOST,SKUPLANNINGPARAM.INCDRPQTY,SKUPLANNINGPARAM.INCMPSQTY,SKUPLANNINGPARAM.INHANDLINGCOST,SKUPLANNINGPARAM.MAXOH AS PLANPARAM_MAXOH,SKUPLANNINGPARAM.MFGFRZDUR,SKUPLANNINGPARAM.MFGLEADTIME,SKUPLANNINGPARAM.MINDRPQTY,SKUPLANNINGPARAM.MINMPSQTY,SKUPLANNINGPARAM.OUTHANDLINGCOST,SKUPLANNINGPARAM.SHRINKAGEFACTOR,SKUPLANNINGPARAM.MPSCOVDUR,SKUPLANNINGPARAM.ORDERINGCOST,SKUPLANNINGPARAM.DRPCOVDUR, SKUSAFETYSTOCKPARAM.MAXSS AS SSPARAM_MAXSS,SKUSAFETYSTOCKPARAM.MINSS,SKUSAFETYSTOCKPARAM.SSCOV,SKUSAFETYSTOCKPARAM.STATSSCSL,SKUSAFETYSTOCKPARAM.ACCUMDUR,SKUSAFETYSTOCKPARAM.AVGLEADTIME,SKUSAFETYSTOCKPARAM.SSRULE,SKUPERISHABLEPARAM.MINSHELFLIFEDUR,SKUPERISHABLEPARAM.MINSHIPSHELFLIFEDUR,SKUPERISHABLEPARAM.SHELFLIFEDUR,SKUPERISHABLEPARAM.MAXSHELFLIFEDUR,SS.EFF AS SS_EFF,SS.QTY,SS.DMDGROUP,SKUIOPARAM.AVGRQSNSIZE,SKUIOPARAM.GROUPNAME,SKUIOPARAM.NUMRQSN,SKUIOPARAM.REVIEWGROUP,SKUIOPARAM.SENSITIVITYPROFILE,SKUEFFIOPARAM.UNITCOST,SKUEFFIOPARAM.STOCKOUTPENALTY,SKUEFFIOPARAM.REVIEWPERIOD,SKUEFFIOPARAM.REPLENPOLICY,SKUEFFIOPARAM.OVERSTOCKPENALTY,SKUEFFIOPARAM.ORDERCOST,SKUEFFIOPARAM.MINREORDERQTY,SKUEFFIOPARAM.MAXREORDERQTY,SKUEFFIOPARAM.IOSERVICEPROFILE,SKUEFFIOPARAM.HOLDINGCOST AS EFFIO_HOLDINGCOST,SKUEFFIOPARAM.HANDLINGCOST,SKUEFFIOPARAM.EVENTTYPE,SKUEFFIOPARAM.ENDOFLIFEDMD,SKUEFFIOPARAM.EFF AS EFFIO_EFF,SKUEFFIOPARAM.COEFFVAR,SKUEFFIOPARAM.BACKORDERPENALTY,STORAGEREQUIREMENT.RES,STORAGEREQUIREMENT.ENABLEOPT AS REQ_ENABLEOPT,SSPRESENTATION.EFF AS SSPR_EFF,SSPRESENTATION.DISC,SSPRESENTATION.PRESENTATIONQTY,SSPRESENTATION.DISPLAYQTY,SSPRESENTATION.MAXSS AS SSPR_MAXSS,SSPRESENTATION.MAXOH AS SSPR_MAXOH FROM SKU SKU LEFT JOIN SKUDEMANDPARAM SKUDEMANDPARAM ON SKU.ITEM = SKUDEMANDPARAM.ITEM AND SKU.LOC = SKUDEMANDPARAM.LOC LEFT JOIN SKUDEPLOYMENTPARAM SKUDEPLOYMENTPARAM ON SKU.ITEM = SKUDEPLOYMENTPARAM.ITEM AND SKU.LOC = SKUDEPLOYMENTPARAM.LOC LEFT JOIN SKUEFFINVENTORYPARAM SKUEFFINVENTORYPARAM ON SKU.ITEM = SKUEFFINVENTORYPARAM.ITEM AND SKU.LOC = SKUEFFINVENTORYPARAM.LOC LEFT JOIN SKUPLANNINGPARAM SKUPLANNINGPARAM ON SKU.ITEM = SKUPLANNINGPARAM.ITEM AND SKU.LOC = SKUPLANNINGPARAM.LOC LEFT JOIN SKUSAFETYSTOCKPARAM SKUSAFETYSTOCKPARAM ON SKU.ITEM = SKUSAFETYSTOCKPARAM.ITEM AND SKU.LOC = SKUSAFETYSTOCKPARAM.LOC LEFT JOIN SKUPERISHABLEPARAM SKUPERISHABLEPARAM ON SKU.ITEM = SKUPERISHABLEPARAM.ITEM AND SKU.LOC = SKUPERISHABLEPARAM.LOC LEFT JOIN SS SS ON SKU.ITEM = SS.ITEM AND SKU.LOC = SS.LOC LEFT JOIN SKUIOPARAM SKUIOPARAM ON SKU.ITEM = SKUIOPARAM.ITEM AND SKU.LOC = SKUIOPARAM.LOC LEFT JOIN SKUEFFIOPARAM SKUEFFIOPARAM ON SKU.ITEM = SKUEFFIOPARAM.ITEM AND SKU.LOC = SKUEFFIOPARAM.LOC LEFT JOIN STORAGEREQUIREMENT STORAGEREQUIREMENT ON SKU.ITEM = STORAGEREQUIREMENT.ITEM AND SKU.LOC = STORAGEREQUIREMENT.LOC LEFT JOIN SSPRESENTATION SSPRESENTATION ON SKU.ITEM = SSPRESENTATION.ITEM AND SKU.LOC = SSPRESENTATION.LOC)"
