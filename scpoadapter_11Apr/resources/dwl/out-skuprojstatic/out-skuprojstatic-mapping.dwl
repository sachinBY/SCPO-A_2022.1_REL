%dw 2.0
output application/json encoding = "UTF-8",deferred=true
var funCaller = readUrl("classpath://config-repo/scpoadapter/resources/dwl/date-util.dwl")
var udcs = vars.outboundUDCs.skuprojstatic[0].skuprojstatic[0]
---
{
	header: {
			sender: p('scpo.outbound.sender'),
		receiver: (splitBy(p("scpo.outbound.skuprojstatic.receivers"), ",") map {
			(receiver: $) if (!isEmpty($))
		}).receiver,
		messageVersion: "BYDM 2021.2.0",
		messageId: uuid(),
		"type": p("scpo.outbound.skuprojstatic.messagetype"),
		creationDateAndTime: now()
	},
	itemLocationProjection: (payload map{
		creationDateTime: now(),
		documentStatusCode: "ORIGINAL",
		documentActionCode: "CHANGE_BY_REFRESH",
		(avpList: (filter(udcs, (element, index) -> $[upper(element.scpoColumnName)] != null) map (udc , value) -> {
			name: udc.hostColumnName,
			value: $[upper(udc.scpoColumnName)]
		})) if (!isEmpty(udcs)),
		itemLocationProjectionIdentification: {
			itemId: $.ITEM,
			locationId: $.LOC,
			startDate: funCaller.formatSCPOToGS1($.STARTDATE),
			optionSet: $.OPTIONSET
		},
		committedIntransitIn: $.COMMITINTRANSIN,
		committedIntransitOut: $.COMMITINTRANSOUT,
		allIntransitIn: $.ALLINTRANSIN,
		actualIntransitIn: $.ACTUALINTRANSIN,
		actualIntransitOut: $.ACTUALINTRANSOUT,
		baseForecast: $.BASEFCST,
		allocatedBaseForecast: $.ALLOCBASEFCST,
		adjustedAllocatedBaseForecast: $.ADJALLOCBASEFCST,
		nonBaseForecast: $.NONBASEFCST,
		allocatedNonBaseForecast: $.ALLOCNONBASEFCST,
		adjustedAllocatedNonBaseForecast: $.ADJALLOCNONBASEFCST,
		allocatedTotalForecast: $.ALLOCTOTFCST,
		adjustedAllocatedTotalForecast: $.ADJALLOCTOTFCST,
		adjustedForecastedCustomerOrder: $.ADJFCSTCUSTORDERS,
		usableProjectedOnHand: $.USEABLEPROJOH,
		constrainedUsableProjectedOnHand: $.CONSTRUSEABLEPROJOH,
		alternateConstrainedUsableProjectedOnHand: $.ALTCONSTRUSEABLEPROJOH,
		expiredOnHand: $.EXPOH,
		unusableOnHand: $.UNUSEOH,
		constrainedUnusableOnHand: $.CONSTRUNUSEOH,
		alternateConstrainedUnusableOnHand: $.ALTCONSTRAINEDUNUSEOH,
		coverageDuration: {
			value: $.COVDUR
		},
		constrainedCoverageDuration: {
			value: $.CONSTRCOVDUR
		},
		alternateConstrainedCoverageDuration: {
			value: $.ALTCONSTRCOVDUR,
		},
		projectedOnHand: $.PROJOH,
		constrainedProjectedOnHand: $.CONSTRPROJOH,
		alternateConstrainedProjectedOnHand: $.ALTCONSTRPOH,
		unusableSupply: $.UNUSEABLESUPPLY,
		constrainedUnusableSupply: $.CONSTRUNUSEABLESUPPLY,
		alternateConstrainedUnusableSupply: $.ALTCONSTRUNUSEABLESUPPLY,
		dependentDemand: $.DEPDMD,
		displayQuantity: $.DISPLAYQTY,
		presentationQuantity: $.PRESENTATIONQTY,
		forecastedCustomerOrder: $.FCSTCUSTORDERS,
		nonForecastedCustomerOrder: $.NONFCSTCUSTORDERS,
		independentDemand: $.INDDMD,
		ignoredDemand: $.IGNOREDDMD,
		totalDemand: $.TOTDMD,
		totalForecast: $.TOTFCST,
		allDemand: $.ALLDMD,
		projectedAvailable: $.PROJAVAIL,
		constrainedProjectedAvailable: $.CONSTRPROJAVAIL,
		supersededConstrainedProjectedAvailable: $.SUPSDCONSTRPROJAVAIL,
		alternateSupersessionConstrainedProjectedAvailable: $.ALTSUPSDCONSTRPROJAVAIL,
		supersededProjectedOnHand: $.SUPSDPROJOH,
		supersededConstrainedProjectedOnHand: $.SUPSDCONSTRPROJOH,
		alternateSupersessionConstrainedProjectedOnHand: $.ALTSUPSDCONSTRPROJOH,
		inventory: $.INVENTORY,
		proxyDemand: $.PROXYDEMAND,
		constrainedProxyDemand: $.CONSTRPROXYDEMAND,
		proxySupply: $.PROXYSUPPLY,
		constrainedProxySupply: $.CONSTRPROXYSUPPLY,
		scheduledExpiredOnHand: $.SCHEDEXPOH,
		constrainedScheduledExpiredOnHand: $.CONSTRSCHEDEXPOH,
		scheduledUnusableOnHand: $.SCHEDUNUSEOH,
		constrainedScheduledUnusableOnHand: $.CONSTRSCHEDUNUSEOH,
		demandForecastUnitToSKUForecast: $.DFUTOSKUFCST,
		firmPlannedArrivals: $.FIRMPLANARRIV,
		firmPlannedOrder: $.FIRMPLANORDER,
		firmPlannedShipments: $.FIRMPLANSHIP,
		firmScheduledReceipt: $.FIRMSCHEDRCPTS,
		holdOutQuantity: $.HOLDOUTQTY,
		maximumOnHand: $.MAXOH,
		plannedArrivals: $.PLANARRIV,
		plannedOrder: $.PLANORDERS,
		plannedProjectedAvailable: $.PLANPROJAVAIL,
		plannedProjectedOnHand: $.PLANPROJOH,
		plannedShipments: $.PLANSHIP,
		proxyIntransitsIn: $.PROXYINTRANSIN,
		proxyIntransitsOut: $.PROXYINTRANSOUT,
		recommendedArrivals: $.RECARRIV,
		proxyRecommendedArrivals: $.PROXYRECARRIV,
		recommendedArrivalsOnHold: $.RECARRIVONHOLD,
		proxyRecommendedShipments: $.PROXYRECSHIP,
		recommendedShipments: $.RECALLOCSHIP,
		recommendedAllocationShipments: $.RECALLOCSHIP,
		scheduledReceipt: $.SCHEDRCPTS,
		skuExternalForecast: $.SKUEXTERNALFCST,
		safetyStock: $.SS,
		statisticalSafetyStock: $.STATSS,
		supplementalOrderQuantity: $.SUPPORDERQTY,
		supersedableAdjustedAllocatedTotalForecast: $.SUPSDADJALLOCTOTALFCST,
		supersedableAdjustedForecastedCustomerOrders: $.SUPSDADJFCSTCUSTORDERS,
		supersedableAllocatedTotalForecast: $.SUPSDALLOCTOTFCST,
		supersedableProjectedAvailable: $.SUPSDPROJAVAIL,
		totalArrivals: $.TOTARRIV,
		totalIntransitIn: $.TOTINTRANSIN,
		totalIntransitOut: $.TOTINTRANSOUT,
		totalRecommendedArrivals: $.TOTRECARRIV,
		totalRecommendedShipments: $.TOTRECSHIP,
		totalShipments: $.TOTSHIP,
		userId: $.USERID
	})
}
