%dw 2.0
output application/csv
var udcs = vars.outboundUDCs.sku[0].sku[0]
var lib = readUrl("classpath://config-repo/scpoadapter/resources/dwl/host-scpo-udc-mapping.dwl")
---
(payload map {
	
	"itemLocation.itemLocationIditemLocation.item.primaryId": $.ITEM,
	"itemLocation.itemLocationIditemLocation.location.primaryId": $.LOC,
	"itemLocation.businessInstanceId": $.ENABLEOPT,
	"itemLocation.statusCode": "ACTIVE",
	"itemLocation.onHandInventoryQuantity.value": $.OH,
	"itemLocation.onHandInventoryPostingDate": ($.OHPOST) as DateTime,
	"itemLocation.resource": $.RES,
	"itemLocation.hasInfiniteSupply": if($.INFINITESUPPLYSW == 0) false else true,
	"itemLocation.isStorable": if($.STORABLESW == 0) false else true,
	"itemLocation.replenishmentMethod": if($.REPLENMETHOD == 1) 'REPLENISHMENT_ONLY' else if($.REPLENMETHOD == 2) 'ALLOCATION_ONLY' else if($.REPLENMETHOD == 3) 'REPLENISHMENT_AND_ALLOCATION' else null,
	"itemLocation.replenishmentType": if($.REPLENTYPE == 1) 'TRANSFERRED' else if($.REPLENTYPE == 2) 'ASSEMBLED' else if($.REPLENTYPE == 4) 'INTERFACE' else if($.REPLENTYPE == 5) 'MPS' else null,
	"itemLocation.demandParameters.cumulativeDemandQuantity.value": $.DMDTODATE,
	"itemLocation.demandParameters.unitCost.value": $.INDDMDUNITCOST,
	"itemLocation.demandParameters.unitMargin.value": $.INDDMDUNITMARGIN,
	"itemLocation.demandParameters.unitInventoryCarryingCost.value": $.UNITCARCOST,
	"itemLocation.demandParameters.unitPrice.value": $.UNITPRICE,
	"itemLocation.demandParameters.pricingCalendar": $.PRICECAL,
	"itemLocation.deploymentParameters.initialStockoutCost.value": $.INITSTKOUTCOST,
	"itemLocation.deploymentParameters.surplusRestockCost.value": $.SURPLUSRESTOCKCOST,
	"itemLocation.effectiveInventoryParameters.effectiveFromDateTime": ($.EFFINV_EFF) as DateTime,
	"itemLocation.effectiveInventoryParameters.maximumCoverageDuration.value": $.MAXCOVDUR,
	"itemLocation.effectiveInventoryParameters.maximumOnHandQuantity.value": $.MAXOHQTY,
	"itemLocation.effectiveInventoryParameters.minimumSafetyStockQuantity.value": $.MINSSQTY,
	"itemLocation.effectiveInventoryParameters.safetyStockCoverageDuration.value": $.SSCOVDUR,
	"itemLocation.effectiveInventoryParameters.demandChannel": $.DMDGROUP,
	"itemLocation.inventoryOptimizationParameters.averageRequisitionQuantity.value": $.AVGRQSNSIZE,
	"itemLocation.inventoryOptimizationParameters.groupName": $.GROUPNAME,
	"itemLocation.inventoryOptimizationParameters.annualRequisitionNumber": $.NUMRQSN,
	"itemLocation.inventoryOptimizationParameters.reviewGroup": $.REVIEWGROUP,
	"itemLocation.inventoryOptimizationParameters.sensitivityProfile": $.SENSITIVITYPROFILE,
	"itemLocation.inventoryOptimizationParameters.inventoryOptimizationEffectiveParameters.backOrderPenaltyAmount.value": $.BACKORDERPENALTY,
	"itemLocation.inventoryOptimizationParameters.inventoryOptimizationEffectiveParameters.coefficientVariation": $.COEFFVAR,
	"itemLocation.inventoryOptimizationParameters.inventoryOptimizationEffectiveParameters.effectiveFromDate": ($.EFFIO_EFF) as Date{format:"yyyy-MM-dd",class:"java.sql.Date"},
	"itemLocation.inventoryOptimizationParameters.inventoryOptimizationEffectiveParameters.endOfLifeDemand": $.ENDOFLIFEDMD,
	"itemLocation.inventoryOptimizationParameters.inventoryOptimizationEffectiveParameters.eventType": $.EVENTTYPE,
	"itemLocation.inventoryOptimizationParameters.inventoryOptimizationEffectiveParameters.handlingCost.value": $.HANDLINGCOST,
	"itemLocation.inventoryOptimizationParameters.inventoryOptimizationEffectiveParameters.holdingCost.value": $.EFFIO_HOLDINGCOST,
	"itemLocation.inventoryOptimizationParameters.inventoryOptimizationEffectiveParameters.inventoryOptimizationServiceProfile": $.IOSERVICEPROFILE,
	"itemLocation.inventoryOptimizationParameters.inventoryOptimizationEffectiveParameters.maximumReOrderQuantity.value": $.MAXREORDERQTY,
	"itemLocation.inventoryOptimizationParameters.inventoryOptimizationEffectiveParameters.minimumReOrderQuantity.value": $.MINREORDERQTY,
	"itemLocation.inventoryOptimizationParameters.inventoryOptimizationEffectiveParameters.orderCost.value": $.ORDERCOST,
	"itemLocation.inventoryOptimizationParameters.inventoryOptimizationEffectiveParameters.overStockPenaltyAmount.value": $.OVERSTOCKPENALTY,
	"itemLocation.inventoryOptimizationParameters.inventoryOptimizationEffectiveParameters.replenishmentPolicy": $.REPLENPOLICY,
	"itemLocation.inventoryOptimizationParameters.inventoryOptimizationEffectiveParameters.reviewPeriodDuration.value": $.REVIEWPERIOD,
	"itemLocation.inventoryOptimizationParameters.inventoryOptimizationEffectiveParameters.stockOutPenaltyAmount.value": $.STOCKOUTPENALTY,
	"itemLocation.inventoryOptimizationParameters.inventoryOptimizationEffectiveParameters.unitCost.value": $.UNITCOST,
	"itemLocation.perishableParameters.shelfLifeDuration.value": $.SHELFLIFEDUR,
	"itemLocation.perishableParameters.minimumShelfLifeDuration.value": $.MINSHELFLIFEDUR,
	"itemLocation.perishableParameters.minimumShipmentShelfLifeDuration.value": $.MINSHIPSHELFLIFEDUR,
	"itemLocation.perishableParameters.maximumShelfLifeDuration.value": $.MAXSHELFLIFEDUR,
	"itemLocation.planningParameters.supplyLeadBufferDuration.value": $.BUFFERLEADTIME,
	"itemLocation.planningParameters.receiptCoverageDuration.value": $.DRPCOVDUR,
	"itemLocation.planningParameters.supplyCoverageDuration.value": $.MPSCOVDUR,
	"itemLocation.planningParameters.receiptFrozenDuration.value": $.DRPFRZDUR,
	"itemLocation.planningParameters.holdingCost.value": $.PLANPARAM_HOLDINGCOST,
	"itemLocation.planningParameters.incrementalDRPQuantity.value": $.INCDRPQTY,
	"itemLocation.planningParameters.incrementalMPSQuantity.value": $.INCMPSQTY,
	"itemLocation.planningParameters.receivingHandlingCost.value": $.INHANDLINGCOST,
	"itemLocation.planningParameters.maximumOnHandQuantity.value": $.PLANPARAM_MAXOH,
	"itemLocation.planningParameters.manufactureDuration.value": $.MFGFRZDUR,
	"itemLocation.planningParameters.manufactureLeadTimeDuration.value": $.MFGLEADTIME,
	"itemLocation.planningParameters.minimumDRPQuantity.value": $.MINDRPQTY,
	"itemLocation.planningParameters.minimumMPSQuantity.value": $.MINMPSQTY,
	"itemLocation.planningParameters.orderingCost.value": $.ORDERINGCOST,
	"itemLocation.planningParameters.shippingHandlingCost.value": $.OUTHANDLINGCOST,
	"itemLocation.planningParameters.shrinkageFactor": $.SHRINKAGEFACTOR,
	"itemLocation.planningParameters.useWorkInProgressQuantity": if($.USEWIPSW == 0) false else true,
	"itemLocation.safetyStockParameters.safetyStockRuleCode": $.SSRULE as String,
	"itemLocation.safetyStockParameters.accumulationDuration.value": $.ACCUMDUR,
	"itemLocation.safetyStockParameters.averageReplenishmentLeadDuration.value": $.AVGLEADTIME,
	"itemLocation.safetyStockParameters.maximumSafetyStock.value": $.SSPARAM_MAXSS,
	"itemLocation.safetyStockParameters.minimumSafetyStock.value": $.MINSS,
	"itemLocation.safetyStockParameters.safetyStockCoverageDuration.value": $.SSCOV,
	"itemLocation.safetyStockParameters.safetyStockCustomerServiceLevel": $.STATSSCSL,
	"itemLocation.safetyStockPresentation.actionCode": "ADD",
	"itemLocation.safetyStockPresentation.effectiveFromDateTime": ($.SSPR_EFF) as DateTime,
	"itemLocation.safetyStockPresentation.effectiveUpToDateTime": ($.DISC) as DateTime,
	"itemLocation.safetyStockPresentation.displayQuantity.value": $.DISPLAYQTY,
	"itemLocation.safetyStockPresentation.presentationQuantity.value": $.PRESENTATIONQTY,
	"itemLocation.safetyStockPresentation.maximumOnHandQuantity.value": $.SSPR_MAXOH,
	"itemLocation.safetyStockPresentation.maximumSafetyStock.value": $.SSPR_MAXSS,
    (udcs map (udc , index) -> {
		((udc.hostColumnName): lib.eval($[udc.scpoColumnName] , upper(udc.dataType)))
	}),
})
